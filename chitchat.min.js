var ChitChat=ChitChat||{};ChitChat.Packet=function(a){this.who=a?a.who:void 0;this.type=a?a.type:void 0;this.message=a?a.message:void 0;this.target=a?a.target:"default"};ChitChat.Provider=function(){this.id="parent";this.consumers=[];this.origin=void 0;this.demosite="chitchat_consumer.html";this.init()};
ChitChat.Provider.prototype={init:function(){this.listener()},addConsumer:function(a){new ChitChat.Packet;a={frame:$("#"+a.data.message).get(0).contentWindow,origin:a.origin,sub:a.data.target};this.consumers.push(a)},msgToFramework:function(){new ChitChat.Packet},listener:function(){window.addEventListener("message",this.routeMessage,!1)},routeMessage:function(a){if("reg"===a.data.type)provider.addConsumer(a);else if("framework"!==a.data.type)for(var c=new ChitChat.Packet({message:a.data.message}),
d=provider.consumers.length,b=0,b=0;b<d;b++)provider.consumers[b].sub===a.data.target&&provider.consumers[b].frame.postMessage(c,provider.consumers[b].origin)}};ChitChat.Consumer=function(a){this.sub=a||"default";this.name=window.frameElement.id;this.init()};
ChitChat.Consumer.prototype={init:function(){this.listeners();this.register()},register:function(){var a=new ChitChat.Packet({type:"reg",message:window.frameElement.id,target:this.sub});window.parent.postMessage(a,"http://localhost")},sendMessage:function(a){a=new ChitChat.Packet({message:a,target:this.sub});window.parent.postMessage(a,"http://localhost")},listeners:function(){window.addEventListener("message",this.getParentMessage,!1)},getParentMessage:function(a){"function"===typeof localFunc?localFunc(a.data.message):
console.error("no local func defined on end point")}};